#include "../utils.h"

int main() {
    BIGNUM* n = BN_new();
    BIGNUM* e = BN_new();
    BIGNUM* M = BN_new();
    BIGNUM* S = BN_new();

    BN_hex2bn(&n, "C14BB3654770BCDD4F58DBEC9CEDC366E51F311354AD4A66461F2C0AEC6407E52EDCDCB90A20EDDFE3C4D09E9AA97A1D8288E51156DB1E9F58C251E72C340D2ED292E156CBF1795FB3BB87CA25037B9A52416610604F571349F0E8376783DFE7D34B674C2251A6DF0E9910ED57517426E27DC7CA622E131B7F238825536FC13458008B84FFF8BEA75849227B96ADA2889B15BCA07CDFE951A8D5B0ED37E236B4824B62B5499AECC767D6E33EF5E3D6125E44F1BF71427D58840380B18101FAF9CA32BBB48E278727C52B74D4A8D697DEC364F9CACE53A256BC78178E490329AEFB494FA415B9CEF25C19576D6B79A72BA2272013B5D03D40D321300793EA99F5");
    BN_hex2bn(&e, "010001");
    BN_hex2bn(&M, "d856dabc22af736b07fb67d57f60ce2b81a5b79b44b7941df886cb573c3a1d4c");
    BN_hex2bn(&S, "46d63c89532aa810971998f6351869c40e1e4b66ff7bfe7a2619d1586cf7c317f46918db699dac507dda1ded540f28388d53e09d22ec1a704c98de51937dae881ff9bfafee46109a976e988bd3186de429b74f7cd0cc53e6186ff1b4e146235aefbfa800e72b60c2441887f6ffd934ca879f6e51194d1d36e9453aa640e1c6332da72351afe21da9033fe2508cea7bbc159fea68b96dbed6b5127abe8c4c0439ba3f3e8068409cc98fb85cbbbae4c8f4082b5ada43da4aeee149dbf160b71214b93f9bcb4e8b9d4a7cd9507b4319678973b64785e00f359dba696990014942f67e49adab49d8f29eb4c379d8d022fdecd631f64ef6a8e5f476ded5b65c042156");

    BN_CTX* ctx = BN_CTX_new();
    BIGNUM* plain = BN_new();
    // verify using public key
    BN_mod_exp(plain, S, e, n, ctx);
    bool v = (BN_cmp(plain, M) == 0);

    printBN("M =", M);
    printBN("Plain =", plain);
    return 0;
}
